# New Search Algorithm Technical Validation 

This README is intended to give an overview of the technical validation framework at a non-technical level.

_Note for developers: It should remain situated in the `Features` folder, such that all non technical aspects of the framework are co-located._

_Any technical documentation additions shoudl not go in this file - please add them to the overall README, or the code itself_


##Feature Files

Test cases are written in feature files - i.e. any file with a type of `.feature`. Files ending in `.feature.cs` are automatically generated by the 
test runner, and can be ignored.

Each feature file should contain tests pertaining to one feature of the algorithm. 
They are split primarily by search type, and within each search type by shared areas of functionality e.g. different typing resolutions, aligned registry searches etc.

The language used in the feature files is called _Cucumber_. (https://cucumber.io/)

###The Structure of a feature file

####Feature
All feature files will start with a block in this format:

```
Feature: Name of the feature
    As a user
    I want the feature to do what I want
```

**Name**
- The first line of the file must start with `Feature:`
- Following this is the name of the feature itself. It can be named anything, though aim to keep this quite short
- The name selected will show up in test reports

**Description** 
- The description should be phrased in the following format: 

- (1) **As a** \<role>
- (2) **I want to** \<action>
- (3) **So that** \<reason>

e.g. 
```
As a member of the search team
I want to be able to run a 10/10 aligned registries search
So that I can match donors in other registries
```

####Scenarios

The rest of a feature file is made up of scenarios. Each scenario represents a single test case.

They are written in the following format:

```
Scenario: Name of the scenario
    Given some setup
    And some additional setup
    And some further additional setup
    When I do a thing
    Then the desired outcome should occur
```

**Name**
- The first line of the scanrio must start with `Scenario:`
- Following this is the name of the scenario
- The name will show up in test reports
- All names must be unique within a scenario

**Steps**

_**IMPORTANT** : Unlike the names of features/scenarios, the phrasing using in steps is important. 
All steps are mapped to code written by developers - if a mapping has not been written, the test will not run. 
If you think the phrasing should be tweaked, or would like to add new steps that do not exist, talk to a developer._

_In general, tweaking phrasing will be a trivial code change, but changing meaning / adding more steps will require some development effort._

Steps will start with one of four keywords, in the following order:

- (1) `Given`
     - This is the first step of any scenario
     - Given describes some set up necessary before we run a search - this will include all information needed to create the search criteria
     - It will generally describe whether we're dealing with one or more patients
- (2) `And`
    - This is functionally the same as `Given`, used to make the tests read more fluently
    - A secenario will generally have multiple `And` lines
- (3) `When`
    - This triggers the functionality under test
    - In almost all cases, this will be running a search
- (4) `Then`
    - This is where we assert the test has passed. 
    - These will generally involve asserting that the expected donor(s) have been returned from the search




